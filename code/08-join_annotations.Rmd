---
title: "08-join-annotations"
output: html_document
date: "2023-12-14"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)

```

## Joining the blast results with our DEGs

```{r}

#read in DEG results
DEG <- read.csv('../output/1213-DEG.tab', sep = " ")
head(DEG)

```

```{r}
# make column with gene names

genenames <- rownames(DEG)

DEG$genes <- genenames

head(DEG)

```

```{r}
# read in BLAST results
blast <- read.delim("../output/GCF_026571515.1.tab", header=FALSE)
head(blast)
```

```{r}
# make sure the column names are the same for the merge

colnames(blast)[1] <- "genes"
head(blast)
```

```{r}
# join by gene name

DEG_Blast <- merge(x = DEG, y = blast, by = "genes")
head(DEG_Blast)

write_delim(DEG_Blast, "../output/DEG_Blast_Full_Results.tab")

```

```{r}
# make a short file of just the DEG names

DEG_annot <- data.frame( geneID = DEG_Blast$genes, geneName = DEG_Blast$V2, baseMean = DEG_Blast$baseMean, log2FoldChange = DEG_Blast$log2FoldChange, pvalue = DEG_Blast$pvalue, padj = DEG_Blast$padj  )

head(DEG_annot)

write_delim(DEG_annot, "../output/DEG_annotations.tab")
```
